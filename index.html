<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>–°–ª–æ–≤–Ω–∏–∫ UA-NL</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDx-0ps9rwDG84BynNgau8RV196ETbvYlw",
            authDomain: "nl-test-52a67.firebaseapp.com",
            projectId: "nl-test-52a67",
            storageBucket: "nl-test-52a67.appspot.com",
            messagingSenderId: "740333223167",
            appId: "1:740333223167:web:ff0e9d937942de87e2e0ca",
            measurementId: "G-3MFK97XRLH"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function addWord() {
    let ukWord = document.getElementById("ukrainianWord").value.trim();
    let nlWord = document.getElementById("dutchWord").value.trim();

    if (ukWord === "" || nlWord === "") {
        alert("–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –æ–±–∏–¥–≤–∞ –ø–æ–ª—è!");
        return;
    }

    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Å–ª–æ–≤–æ –≤–∂–µ —ñ—Å–Ω—É—î
    const querySnapshot = await getDocs(collection(db, "words"));
    const words = querySnapshot.docs.map(doc => doc.data());
    const wordExists = words.some(word => word.uk === ukWord && word.nl === nlWord);

    if (wordExists) {
        alert("–¶–µ —Å–ª–æ–≤–æ –≤–∂–µ —ñ—Å–Ω—É—î –≤ —Å–ª–æ–≤–Ω–∏–∫—É!");
        return;
    }

    // –î–æ–¥–∞—î–º–æ –Ω–æ–≤–µ —Å–ª–æ–≤–æ
    await addDoc(collection(db, "words"), { uk: ukWord, nl: nlWord });
    document.getElementById("ukrainianWord").value = "";
    document.getElementById("dutchWord").value = "";

    // –û–Ω–æ–≤–ª—é—î–º–æ —Ç–∞–±–ª–∏—Ü—é
    loadWords();
}

        async function loadWords() {
    let wordList = document.getElementById("wordList");
    wordList.innerHTML = ""; // –û—á–∏—â—É—î–º–æ —Ç–∞–±–ª–∏—Ü—é –ø–µ—Ä–µ–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º –Ω–æ–≤–∏—Ö —Å–ª—ñ–≤
    const querySnapshot = await getDocs(collection(db, "words"));
    querySnapshot.forEach((doc) => {
        let word = doc.data();
        let row = `
            <tr>
                <td>${word.uk}</td> <!-- –£–∫—Ä–∞—ó–Ω—Å—å–∫–µ —Å–ª–æ–≤–æ -->
                <td>${word.nl}</td> <!-- –ù—ñ–¥–µ—Ä–ª–∞–Ω–¥—Å—å–∫–µ —Å–ª–æ–≤–æ -->
                <td>
                    <!-- –ö–Ω–æ–ø–∫–∞ –æ–∑–≤—É—á—É–≤–∞–Ω–Ω—è -->
                    <button class="btn btn-primary btn-sm" onclick="speak('${word.nl}')">üì¢</button>
                    <!-- –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è -->
                    <button class="btn btn-danger btn-sm ms-2" onclick="deleteWord('${doc.id}')">‚úñ</button>
                </td>
            </tr>`;
        wordList.innerHTML += row; // –î–æ–¥–∞—î–º–æ —Ä—è–¥–æ–∫ –¥–æ —Ç–∞–±–ª–∏—Ü—ñ
    });
}
        async function deleteWord(id) {
            await deleteDoc(doc(db, "words", id));
            loadWords();
        }

        window.speak = function(text) {
            let utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = "nl-NL";
            speechSynthesis.speak(utterance);
        };


        async function speak(text, lang = "nl-NL") {
    const url = `https://texttospeech.googleapis.com/v1/text:synthesize?key=YOUR_API_KEY`;
    const response = await fetch(url, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            input: { text },
            voice: { languageCode: lang, ssmlGender: "NEUTRAL" },
            audioConfig: { audioEncoding: "MP3" }
        })
    });
    const data = await response.json();
    const audio = new Audio(`data:audio/mp3;base64,${data.audioContent}`);
    audio.play();
}

        async function translateWord() {
            let ukWord = document.getElementById("ukrainianWord").value.trim();
            if (!ukWord) {
                alert("–í–≤–µ–¥—ñ—Ç—å —Å–ª–æ–≤–æ –¥–ª—è –ø–µ—Ä–µ–∫–ª–∞–¥—É!");
                return;
            }

            let url = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(ukWord)}&langpair=uk|nl`;

            try {
                let response = await fetch(url);
                let data = await response.json();
                document.getElementById("dutchWord").value = data.responseData.translatedText;
            } catch (error) {
                console.error("–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–∫–ª–∞–¥—É:", error);
                alert("–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–∫–ª–∞–¥—É. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑!");
            }
        }

        window.startSpeechRecognition = function() {
            let recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = "uk-UA";
            recognition.start();

            recognition.onresult = function(event) {
                let transcript = event.results[0][0].transcript;
                document.getElementById("ukrainianWord").value = transcript;
            };

            recognition.onerror = function(event) {
                alert("–ü–æ–º–∏–ª–∫–∞ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –≥–æ–ª–æ—Å—É: " + event.error);
            };
        };

        window.addWord = addWord;
        window.loadWords = loadWords;
        window.deleteWord = deleteWord;
        window.translateWord = translateWord;

        // –ì—Ä–∞
        let words = [];
        let correctAnswer = "";
        let currentQuestion = {};

        async function startQuiz() {
            words = [];
            const querySnapshot = await getDocs(collection(db, "words"));
            querySnapshot.forEach((doc) => {
                words.push(doc.data());
            });

            askQuestion();
        }

        function askQuestion() {
            if (words.length === 0) {
                alert("–ù–µ–º–∞—î —Å–ª—ñ–≤ —É –±–∞–∑—ñ –¥–∞–Ω–∏—Ö!");
                return;
            }

            const randomWord = words[Math.floor(Math.random() * words.length)];
            currentQuestion = randomWord;

            const options = words
                .filter(word => word.nl !== randomWord.nl)
                .slice(0, 3)
                .map(word => word.nl);
            options.push(randomWord.nl);

            // –ü–µ—Ä–µ–º—ñ—à—É—î–º–æ –≤–∞—Ä—ñ–∞–Ω—Ç–∏
            options.sort(() => Math.random() - 0.5);

            document.getElementById("question").textContent = randomWord.uk;
            document.getElementById("options").innerHTML = options.map((option, index) =>
                `<button class="btn btn-outline-secondary mt-2 w-100" onclick="checkAnswer('${option}')">${option}</button>`
            ).join("");
        }

        function checkAnswer(selectedAnswer) {
            const isCorrect = selectedAnswer === currentQuestion.nl;

            const buttons = document.querySelectorAll("#options button");
            buttons.forEach(button => button.disabled = true);

            if (isCorrect) {
                document.getElementById("feedback").textContent = "–ü—Ä–∞–≤–∏–ª—å–Ω–æ!";
                document.getElementById("feedback").style.color = "green";
            } else {
                document.getElementById("feedback").textContent = "–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!";
                document.getElementById("feedback").style.color = "red";
            }

            setTimeout(() => {
                askQuestion();
                document.getElementById("feedback").textContent = "";
            }, 1500);
        }

        document.addEventListener("DOMContentLoaded", loadWords);

        window.addBulkWords = async function () {
    // –û—Ç—Ä–∏–º—É—î–º–æ —Ç–µ–∫—Å—Ç –∑ —ñ–Ω–ø—É—Ç–∞
    let bulkText = document.getElementById("bulkWordsInput").value.trim();
    if (!bulkText) {
        alert("–ë–ª–æ–∫ –≤–≤–æ–¥—É –ø–æ—Ä–æ–∂–Ω—ñ–π! –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —Å–ª–æ–≤–∞.");
        return;
    }

    // –†–æ–∑–±–∏–≤–∞—î–º–æ —Ç–µ–∫—Å—Ç –Ω–∞ —Ä—è–¥–∫–∏
    let lines = bulkText.split("\n");

    // –ú–∞—Å–∏–≤ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫
    let errors = [];

    // –û–±—Ä–æ–±–ª—è—î–º–æ –∫–æ–∂–µ–Ω —Ä—è–¥–æ–∫
    for (let line of lines) {
        // –í–∏–¥–∞–ª—è—î–º–æ –∑–∞–π–≤—ñ –ø—Ä–æ–±—ñ–ª–∏
        line = line.trim();

        // –†–æ–∑–±–∏–≤–∞—î–º–æ —Ä—è–¥–æ–∫ –Ω–∞ –¥–≤—ñ —á–∞—Å—Ç–∏–Ω–∏ –∑–∞ —Å–∏–º–≤–æ–ª–æ–º "‚Äì"
        let parts = line.split("‚Äì").map(part => part.trim());

        if (parts.length !== 2 || !parts[0] || !parts[1]) {
            errors.push(`–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç: "${line}"`);
            continue; // –ü—Ä–æ–ø—É—Å–∫–∞—î–º–æ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Ä—è–¥–æ–∫
        }

        let nlWord = parts[0]; // –ù—ñ–¥–µ—Ä–ª–∞–Ω–¥—Å—å–∫–µ —Å–ª–æ–≤–æ
        let ukWord = parts[1]; // –£–∫—Ä–∞—ó–Ω—Å—å–∫–µ —Å–ª–æ–≤–æ

        try {
            // –î–æ–¥–∞—î–º–æ —Å–ª–æ–≤–æ –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
            await addDoc(collection(db, "words"), {
                uk: ukWord,
                nl: nlWord
            });
        } catch (error) {
            errors.push(`–ü–æ–º–∏–ª–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Å–ª–æ–≤–∞ "${line}": ${error.message}`);
        }
    }


    // –û—á–∏—â—É—î–º–æ —ñ–Ω–ø—É—Ç
    document.getElementById("bulkWordsInput").value = "";

    // –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ç–∞–±–ª–∏—Ü—é
    loadWords();
};

        

        window.startQuiz = startQuiz;
    window.checkAnswer = checkAnswer;



        
    </script>
</head>
<body class="bg-light">

    <div class="container mt-5">
        <h2 class="text-center mb-4">–°–ª–æ–≤–Ω–∏–∫ –£–∫—Ä–∞—ó–Ω—Å—å–∫–æ-–ù—ñ–¥–µ—Ä–ª–∞–Ω–¥—Å—å–∫–∏–π</h2>

       
        <!-- –§–æ—Ä–º–∞ –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Å–ª—ñ–≤ -->
        <div class="row g-2">
            <div class="col-md-4 d-flex">
                <input type="text" id="ukrainianWord" class="form-control" placeholder="–£–∫—Ä–∞—ó–Ω—Å—å–∫–µ —Å–ª–æ–≤–æ">
                <button class="btn btn-secondary ms-2" onclick="startSpeechRecognition()">üéô</button>
            </div>
            <div class="col-md-3">
                <button class="btn btn-warning w-100" onclick="translateWord()">–ü–µ—Ä–µ–∫–ª–∞—Å—Ç–∏</button>
            </div>
            <div class="col-md-4">
                <input type="text" id="dutchWord" class="form-control" placeholder="–ù—ñ–¥–µ—Ä–ª–∞–Ω–¥—Å—å–∫–µ —Å–ª–æ–≤–æ">
            </div>
            <div class="col-md-1">
                <button class="btn btn-primary w-100" onclick="addWord()">–î–æ–¥–∞—Ç–∏</button>
            </div>
        </div>

        <!-- –¢–∞–±–ª–∏—Ü—è —Å–ª—ñ–≤ -->
        <table class="table table-bordered mt-4">
            <thead class="table-dark">
                <tr>
                    <th>–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</th>
                    <th>–ù—ñ–¥–µ—Ä–ª–∞–Ω–¥—Å—å–∫–∞</th>
                    <th>–î—ñ—ó</th>
                </tr>
            </thead>
            <tbody id="wordList">
                <!-- –î–∏–Ω–∞–º—ñ—á–Ω–æ –¥–æ–¥–∞—é—Ç—å—Å—è —Å–ª–æ–≤–∞ -->
            </tbody>
        </table>

         <!-- –ö–Ω–æ–ø–∫–∞ "–ì—Ä–∞—Ç–∏" -->
          
         <div class="text-center">
            <button class="btn btn-success" onclick="startQuiz()">–ì—Ä–∞—Ç–∏</button>
        </div>

        <div class="mt-4">
            <!-- –ü–∏—Ç–∞–Ω–Ω—è -->
            <div id="question" class="text-center h4"></div>

            <!-- –í—ñ–¥–ø–æ–≤—ñ–¥—ñ -->
            <div id="options" class="mt-3"></div>

            <!-- –í—ñ–¥–≥—É–∫ –ø—ñ—Å–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ -->
            <div id="feedback" class="text-center mt-3"></div>
        </div>

        <!-- –ë–ª–æ–∫ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –±–∞–≥–∞—Ç—å–æ—Ö —Å–ª—ñ–≤ –æ–¥–Ω–æ—á–∞—Å–Ω–æ -->
<div class="row g-2 mt-4">
    <div class="col-md-9">
        <textarea id="bulkWordsInput" class="form-control" rows="5" placeholder="–í—Å—Ç–∞–≤—Ç–µ –ø–∞—Ä–∏ —Å–ª—ñ–≤ —É —Ñ–æ—Ä–º–∞—Ç—ñ '–ù—ñ–¥–µ—Ä–ª–∞–Ω–¥—Å—å–∫–µ —Å–ª–æ–≤–æ ‚Äì –£–∫—Ä–∞—ó–Ω—Å—å–∫–µ —Å–ª–æ–≤–æ'"></textarea>
    </div>
    <div class="col-md-3">
        <button class="btn btn-success w-100" onclick="addBulkWords()">–î–æ–¥–∞—Ç–∏ –≤—Å—ñ —Å–ª–æ–≤–∞</button>
    </div>
</div>

    </div>

</body>
</html>
